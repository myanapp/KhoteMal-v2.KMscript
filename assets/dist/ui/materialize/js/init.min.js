const KM = {
    init: () => {
        prefix = document.querySelectorAll('data[km-prefix=onload]');
        for (var i = 0; i < prefix.length; i++) {
            js = prefix[i];
            eval(js.innerHTML);
            js.remove();
            setTimeout(function () {
                M.AutoInit();
            }, 120)
        }
    },
    require: (file, mode) => {
        str = file.slice(0, 1);
        console.log(str)
        switch (str) {
            case "/":
                file = '/pages' + file + '.html';
                break;
            default:
                file = '/pages/_layouts/' + file + '.html';
        }

        jsn = new XMLHttpRequest();
        jsn.onreadystatechange = function () {
            if (this.readyState == 4) {
                document.querySelector((mode || 'body')).innerHTML += this.response;
            }
        }
        jsn.open('GET', file, true);
        jsn.send();
    },
    setTitle: (title) => document.head.innerHTML = '<title>' + title + '</title>' + ' [KHOTEMAL]',
    script: (file) => {
        file = '/assets/' + file + '.js';
        jsn = new XMLHttpRequest();
        jsn.onreadystatechange = function () {
            if (this.readyState == 4) {
                jsx = this.responseText;
                try {
                    setTimeout(function () {
                        eval(jsx)
                    })
                } catch (e) {
                    console.log(file, e.message)
                }
            }
        }
        jsn.open('GET', file, true);
        jsn.send();
    }
}

KM.init();